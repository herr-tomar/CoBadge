package osplus.pkptuna.hazelcast.bootstrap;

import com.hazelcast.core.HazelcastInstance;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import osplus.pkptuna.hazelcast.pubsub.GenericHazelcastConsumer;
import osplus.pkptuna.hazelcast.router.GenericHazelcastRouter;
import osplus.pkptuna.hazelcast.flows.FlowHandlerRegistry;
import osplus.pkptuna.hazelcast.configprops.HazelcastFlowConfigs;

@Configuration
public class HazelcastInfraBootstrap {

    @Bean
    public GenericHazelcastConsumer genericHazelcastConsumer(
            HazelcastInstance hazelcastInstance,
            HazelcastFlowConfigs flowConfigs,
            FlowHandlerRegistry registry
    ) {
        return new GenericHazelcastConsumer(hazelcastInstance, flowConfigs, registry);
    }

    @Bean
    public GenericHazelcastRouter genericHazelcastRouter(
            HazelcastInstance hazelcastInstance,
            HazelcastFlowConfigs flowConfigs,
            FlowHandlerRegistry registry
    ) {
        return new GenericHazelcastRouter(hazelcastInstance, flowConfigs, registry);
    }

    @Bean
    public FlowHandlerRegistry flowHandlerRegistry() {
        return new FlowHandlerRegistry();
    }
}
