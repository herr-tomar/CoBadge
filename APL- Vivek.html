    - name: dispute-detail
      requestTopic: DisputeDetailRequestReliableTopic
      responseTopic: DisputeDetailResponseReliableTopic
      mapBase: dispute-detail-request-map-
      partitions: 3

 @Scheduled(fixedRate = 1000)
public void pollRequestMaps() {
    for (HazelcastFlowConfigs.FlowConfig config : flowConfigs.flows()) {
        String baseMap = config.mapBase();
        int partitions = config.partitions();
        String responseTopic = config.responseTopic();
        String flowName = config.name();

        for (int i = 0; i < partitions; i++) {
            String mapName = baseMap + i;
            IMap<String, Object> map = hazelcastInstance.getMap(mapName); // ⬅️ use Object instead of byte[]

            for (Map.Entry<String, Object> entry : map.entrySet()) {
                String correlationId = entry.getKey();
                Object rawRequest = entry.getValue(); // no casting to byte[]

                try {
                    FlowHandler<Object, Object> handler = flowHandlerRegistry.getHandler(flowName);

                    // No need for deserialization anymore
                    Object response = handler.handleRequest(rawRequest);
                    Object wrapped = handler.wrapResponse(correlationId, response);

                    handler.sendResponse(hazelcastInstance, responseTopic, wrapped);
                    map.remove(correlationId);

                    LOGGER.info("✅ Processed and removed entry from {} with correlationId={}", mapName, correlationId);

                } catch (Exception e) {
                    LOGGER.error("❌ Failed to process request from {}: {}", mapName, e.getMessage(), e);
                }
            }
        }
    }
}
