package osplus.pkptuna.hazelcast.protobuf;

import java.io.IOException;

public interface SimpleDeserializer <T> {
    T deserialize(byte[] data) throws IOException;
}


    package osplus.pkptuna.hazelcast.protobuf;

import java.io.IOException;

public interface SimpleSerializer <T> {
    byte[] serialize(T message) throws IOException;
}


package osplus.pkptuna.hazelcast.protobuf.impl;

import com.google.protobuf.Message;
import com.google.protobuf.Parser;
import osplus.pkptuna.hazelcast.protobuf.SimpleDeserializer;

import java.io.IOException;

public class ProtobufDeserializer<T extends Message> implements SimpleDeserializer<T> {
    private final Parser<T> parser;

    public ProtobufDeserializer(Parser<T> parser) {
        this.parser = parser;
    }

    @Override
    public T deserialize(byte[] bytes) throws IOException {
        return parser.parseFrom(bytes);
    }

}


package osplus.pkptuna.hazelcast.protobuf.impl;

import com.google.protobuf.Message;
import osplus.pkptuna.hazelcast.protobuf.SimpleSerializer;

public class ProtobufSerializer<T extends Message> implements SimpleSerializer<T> {
    @Override
    public byte[] serialize(T message) {
        return message.toByteArray();
    }

}
