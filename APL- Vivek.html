@Scheduled(fixedRate = 1000)
public void pollRequestMaps() {
    for (Map.Entry<String, HazelcastFlowConfigs.FlowConfig> entry : flowConfigs.getFlowMap().entrySet()) {
        String flowName = entry.getKey();
        HazelcastFlowConfigs.FlowConfig config = entry.getValue();

        FlowHandler<?, ?> handler = handlerRegistry.get(flowName);
        if (handler == null) {
            LOGGER.warn("No handler found for flow: {}", flowName);
            continue;
        }

        // Cast for generic operations
        @SuppressWarnings("unchecked")
        FlowHandler<Object, Object> typedHandler = (FlowHandler<Object, Object>) handler;

        for (int i = 0; i < config.partitions(); i++) {
            String mapName = config.mapBase() + i;
            IMap<String, Object> requestMap = hazelcastInstance.getMap(mapName);

            for (Map.Entry<String, Object> item : requestMap.entrySet()) {
                String correlationId = item.getKey();
                Object rawRequest = item.getValue();

                try {
                    Object response = typedHandler.handleRequest(rawRequest);
                    Object wrappedResponse = typedHandler.wrapResponse(correlationId, response);

                    typedHandler.sendResponse(hazelcastInstance, config.responseTopic(), wrappedResponse);
                    requestMap.remove(correlationId);

                    LOGGER.info("✅ Processed and removed request [{}] from map [{}]", correlationId, mapName);

                } catch (Exception e) {
                    LOGGER.error("❌ Error processing request [{}] in map [{}]: {}", correlationId, mapName, e.getMessage(), e);
                }
            }
        }
    }
}
