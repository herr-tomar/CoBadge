@Bean
public MetricsService metricsService() {
    MetricsService mock = mock(MetricsService.class);
    doNothing().when(mock).increaseCounter(any(), any());
    when(mock.timer(any(), any(), any(), any())).thenAnswer(invocation -> {
        Function<Object, Object> fn = invocation.getArgument(0);
        Object param = invocation.getArgument(1);
        return fn.apply(param);
    });
    return mock;
}
