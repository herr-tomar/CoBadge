Fachliche Beschreibung:
Der Service dient dazu, eine Reklamation zu einem Cobadge-Umsatz im IDM anzulegen.
IBO-IDM ist ein CoBadge-System, indem der DMC/VID Teil der Spk-Card CoBadge DMC/VID verwaltet und durch die qards (Service-Prozessor der Sparkassen) prozessiert wird.
Zusätzlich zu den übergebenen Daten lädt der Service weitere Daten, die vom IDM benötigt werden.
Die Kommunikation mit dem IDM erfolgt immer über ein Gateway.
Das Ergebnis aus dem IDM wird dann vom Service zurückgeliefert.
Der Service nimmt folgende Parameter entgegen, die zu einer Reklamation erfasst werden:
- IMPM_IMPS_OID: Eindeutige Identifikation des Impulses im OSPlus
- UMSATZ_ID: Eindeutige Identifikation eines Umsatzes eines Empfänger-Kontos
- EMPF_KONTO_ID: Eindeutige Identifikation des Empfängerkontos der Transaktion
- IMPS_KTGR: Grund der Reklamation (Kategorie Ebene 1)
- ORIG_BTRG_TBTR: Nur bei einer Teilreklamation gefüllt. Enthält in dem Fall den zu reklamierenden Betrag in der verfügten Währung.
- KARTEN_SPERR_KZ: Kennzeichen, ob Karte gesperrt werden soll
- CBD_UMS_ERST_AUTO_ANZ: Anzahl der bereits erhaltenen automatischen Erstattungen eines KI im abgefragten Zeitraum
Der Service bestimmt über einen Aufruf des Shared-Service UmsatzInternLesen weitere Daten zu dem Umsatz:
- UMSATZ_BETRAG: Gesamtbetrag, mit dem das Karteninhaber-Konto belastet wurde. Währung ist die aus dem Zahlungsverkehr (EUR).
- EMPF_BLZ: Bankleitzahl des Empfängerkontos
- CRD_TA_TRACE_NR: Transaction Life Cycle ID
- CRD_PAN: PrimaryAccountNumber
- SEP_UTMT_CRED_ID: AcquiringReferenceNumber
- CRD_TA_DATE_TIME: Zeitpunkt der Verfügung (Ortszeit)
- CRD_VERFALL_MON: Verfall Jahr/ Monat der verwendeten Karte
- CRD_VFGG_ORIG_KURS: Umrechnungskurs bei einer Transaktion in Fremdwährung
- CRD_VFGG_ORIG_WS: Original-Währungsschlüssel
- CRD_VFGG_ORIG_BTRG: verfügter Betrag in Original-Währung
Der Service liest die Institutswerte:
- DMC-MAXBT-AE: Maximaler Betrag für automatische Erstattung
- DMC-MAXAZ-AE: Maximaler Anzahl automatischer Erstattungen im Zeitraum
- DMC-SVPROC-I: Kurztext für den Kartenprozessor
Der Service bestimmt dann anhand der gelesenen und übergebenen Daten, ob eine automatische Erstattung zulässig ist oder nicht.
Alle für das Anlegen der Reklamation im IDM benötigten Daten werden anschließend in einem Aufruf an das Gateway übergeben:
- impulsOId: IMPULS_OID
- umsatzId: UMSATZ_ID
- empfKontoId: EMPF_KONTO_ID
- empfBlz: EMPF_BLZ
- reklaGrundKat1: REKLA_GRUND_KAT_1
- reklaBetrag: TEILBETRAG bei Teilreklamation, sonst UMSATZ_BETRAG
- reklaBetragWs: CRD_VFGG_ORIG_WS bei Teilreklamation, sonst EUR
- reklaTeilbetragKz: Kennzeichen, ob Voll- oder Teilreklamation (J/N)
- karteSperren: KARTE_SPERREN_KZ
- autoErstattungKz: Prüfergebnis, ob automatische Erstattung zulässig ist (J/N)
- crdVfggOrigWs: CRD_VFGG_ORIG_WS
- crdVfggOrigBtrg: CRD_VFGG_ORIG_BTRG
- crdVfggOrigKurs: CRD_VFGG_ORIG_KURS
- crdVerfallMon: CRD_VERFALL_MON
- crdTaTraceNr: CRD_TA_TRACE_NR
- primaryAccountNumber: CRD_PAN
- acquiringReferenceNumber: SEP_UTMT_CRED_ID
- transactionDateAndTime: CRD_TA_DATE_TIME
- IssuerId: Eindeutige Id des Mandanten für das IDM, aus dem Kartenprozessor abgeleitet
Der Service gibt zurück:
- REKL_VGNG_INTN_NR: ID des dispute Folders im IDM
- CBD_UMS_ERST_AUTO_KZ: Prüfergebnis, ob automatische Erstattung zulässig ist (J/N)						
Vorbedingungen:
Der entsprechende Umsatz ist im System verbucht und über UMSATZ_ID + EMPF_KONTO_ID eindeutig identifizierbar.							
Nachbedingungen:
Im IDM wird der Reklamationsantrag für einen DMC/VID Umsatz als Dispute Folder angelegt und durch den Service-Prozessor qards bearbeitet. Daraus resultiert je nach Ausgang der Reklamation ein Refund oder Redebit des reklamierten DMC/VID Umsatzes.		
