syntax = "proto3";

package osplus.pkptuna.dispute.model;

import "google/protobuf/timestamp.proto";

option java_package = "osplus.pkptuna.dispute.model";
option java_outer_classname = "DisputeCreateProto";
option java_multiple_files = true;

/* =======================
   Request (wrapper + body)
   ======================= */

message DisputeCreateRequestWrapperDto {
  string correlationId = 1;
  DisputeCreateRequestDto payload = 2;
}

message DisputeCreateRequestDto {
  DisputeCreateRequestIboDto body = 1;
  string issuerId = 2;
}

message DisputeCreateRequestIboDto {
  string disputeReason = 1;
  string refundRedebitIndicator = 2;
  AmountDto refundRedebitAmount = 3;
  bool declareFraudIndicator = 4;

  repeated DisputePostingRequestDto disputePostings = 5;
  repeated DisputeEventRequestDto disputeEvents = 6;
  repeated DisputeDocumentRequestDto disputeDocuments = 7;
}

message AmountDto {
  int64 value = 1;
  int32 exponent = 2;
  string isoCode = 3;
}

message DisputePostingRequestDto {
  AmountDto postingAmount = 1;
  string message = 2;
  bool immediateReimbursement = 3;
  string postingTypeReference = 4;
}

message DisputeEventRequestDto {
  string type = 1;
  string message = 2;
}

// Use bytes if payload is Base64; switch to string if plain text is required.
message DisputeDocumentRequestDto {
  bytes data = 1;
  string type = 2;
  string label = 3;
  string fileName = 4;
  string documentTypeId = 5;
}

/* =======================
   Response (wrapper + body)
   ======================= */

// >>> ResponseMetadataDto is now ONLY in the wrapper <<<
message DisputeCreateResponseWrapperDto {
  string correlationId = 1;                 // transport correlation (optional)
  ResponseMetadataDto responseMetadata = 2; // moved here from the DTO
  DisputeCreateResponseDto response = 3;    // actual business payload
}

message ResponseMetadataDto {
  string correlationId = 1;
  LinksDto links = 2;
  string statusMessage = 3;
  int32 statusCode = 4;
  string responseDateTime = 5; // keep string to preserve "yyyy-MM-dd'T'HH:mm:ss.SSSZ"
  int64 timeTakenMs = 6;
}

message LinksDto {
  string self = 1;
  string next = 2;
}

// Business payload only (no responseMetadata here)
message DisputeCreateResponseDto {
  DisputeCreateDataDto data = 1;
}

message DisputeCreateDataDto {
  DisputeFolderIdentifierDto disputeFolderIdentifier = 1;
  repeated DisputePostingResponseDto disputePostings = 2;
  repeated DisputeEventResponseDto disputeEvents = 3;
  repeated DisputeDocumentResponseDto disputeDocuments = 4;
}

message DisputeFolderIdentifierDto {
  string disputeFolderReference = 1;
  string issuerDisputeExternalReference = 2;
}

message DisputePostingResponseDto {
  AmountDto postingAmount = 1;
  string postingTypeReference = 2;
  google.protobuf.Timestamp creationDate = 3;
}

message DisputeEventResponseDto {
  string type = 1;
  google.protobuf.Timestamp creationDate = 2;
}

message DisputeDocumentResponseDto {
  string fileName = 1;
  google.protobuf.Timestamp creationDate = 2;
  string documentTypeId = 3;
}
