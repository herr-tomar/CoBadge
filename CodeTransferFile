package osplus.pkptuna.hazelcast.config;

import jakarta.annotation.PostConstruct;
import osplus.apl.core.api.AplComponent;
import osplus.pkptuna.hazelcast.pubsub.GenericHazelcastConsumer;
import osplus.pkptuna.hazelcast.pubsub.GenericHazelcastRouter;

/**
 * Bootstrap-Klasse zur Initialisierung der Hazelcast-Komponenten beim Start.
 * Ruft nach dem Start {@code initRouters()} und {@code startPolling()} auf.
 */
@AplComponent
public class HazelcastFlowBootstrap {

    private final GenericHazelcastRouter router;
    private final GenericHazelcastConsumer consumer;

    public HazelcastFlowBootstrap(GenericHazelcastRouter router,
                                  GenericHazelcastConsumer consumer) {
        this.router = router;
        this.consumer = consumer;
    }

    /**
     * Wird nach Initialisierung automatisch aufgerufen.
     * Startet das Routing und Polling f√ºr alle konfigurierten Flows.
     */
    @PostConstruct
    public void startFlowInfra() {
        router.initRouters();
        consumer.startPolling();
    }
}
