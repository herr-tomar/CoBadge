public void initRouters() {
    try {
        IMap<String, String> leaderMap = hazelcastInstance.getMap("router-leader-map");
        IMap<String, Long> heartbeatMap = hazelcastInstance.getMap("router-heartbeat-map");

        String currentLeader = leaderMap.get("active-router");
        Long lastHeartbeat = heartbeatMap.get("heartbeat");

        boolean heartbeatStale = (lastHeartbeat == null || System.currentTimeMillis() - lastHeartbeat > 5000);

        if (heartbeatStale) {
            // Either no leader or leader is stale; attempt to become the new leader
            String previous = leaderMap.put("active-router", routerInstanceId);

            if (previous == null || previous.equals(currentLeader)) {
                LOGGER.info("This node is elected as the ACTIVE router (ID={})", routerInstanceId);
                startHeartbeat();
                subscribeToTopics();
            } else {
                LOGGER.info("Another node claimed leadership before us (ID={})", previous);
            }
        } else {
            LOGGER.info("Leadership already exists and heartbeat is alive (Leader={}, LastBeat={})",
                    currentLeader, lastHeartbeat);
        }
    } catch (Exception e) {
        LOGGER.error("Failed to initialize router", e);
    }
}
